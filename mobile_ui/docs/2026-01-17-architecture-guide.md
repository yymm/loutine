### 基本的な考え方
- アーキテクチャは必要以上に複雑にしない
- クリーンアーキテクチャなど標準的なアーキテクチャの考え方は活用するがboilerplateや一般的な型に無理やり合わせることはしない
	- 理由としては世の中の多くの一般的な型はエンタープライズを想定しているものが多くToo Muchであることが多いため
- ライブラリへの依存は最低限にする、過剰に多くのThird Partyに依存しない

### トップレベルのアーキテクチャ概要
トップレベルのレイヤーは、ui <- state <- models <-> apiの依存関係を想定しています。
riverpodとgo_routerを使うことを前提としています、riverpodはmain.dartで、go_routerはrouter.dartでセットアップしています。
riverpodのstateを利用するWidgetはConsumerWidgetとして定義する必要があります。
新しい画面を作成するときはgo_routerに定義を追加して、遷移元のページから移動できるようにする。

### トップレベルのレイヤーについての説明
##### ui: CunsumerWidgetを定義する場所
- ページごとにフォルダを作成し、フォルダ名は画面をシンプルに表現した名称とする、命名はsnake_case
- ページがネストする場合は、フォルダもネストさせる、その際フォルダ名には親フォルダの名前を付けなくてもよい
- ファイル名には先頭にフォルダ名を必ずつける、ネスとしている場合はsnake_caseでつなげる、命名はsnake_case
- uiのentry pointは`_main`で終わるファイル名とする
	- StatelessWidgetでScaffoldをreturnする想定、ui全体のレイアウトを定義する場所
- `_main`から参照されるWidgetは好きに作ってよい、ある程度長いコードになっても過剰に分割するよりは良いという考え方を採用している

##### state: StateNorifierを定義する場所
- `_state`で終わるファイル名とする
- 新規作成のフォームに対応する場合は `_new_state`で終わるファイル名とする
- 一覧取得の場合は `_list_state`で終わるファイル名とする
- [課題] riverpodの使い方を完全にマスターしているわけではないのでこの実装でよいのか心配はある
- [課題] フォルダに分けても良いかもしれない、categoryやlinkなどに対してnewとlist、たぶん今後はupdateなど複数の振る舞いが定義されることが予想されるので、categoryやlinkという粒度でフォルダを作成して整理してもよさそう。悩ましいポイントはuiにある画面ごとに作る構成とするか、stateの考え方でフォルダを作るのかのやり方は考えられる（何のためにuiと分けているんだ？となるので、たぶん後者のほうが良いが、画面に対応したstate定義が必要になるので依存関係はある悩ましい、どういう考え方がbetterなのか？）

##### models: データ構造の定義
- pure dartのclassで記述すること
- classの名前と同じファイル名、ただしsnake_case
- factoryメソッドを作成して生成するようにする
	- 生成にはいろいろなパターンがある

##### api: backendへのAPIコール実装
- httpライブラリを利用したプリミティブな実装としている
	- retrofitとdioというパターンがあることは知っているが、コード生成に頼るのが途中からだとしんどかったので見送っている
		- [雑談] 生成AI時代にコードジェネレーターの必要性って下がってきそう...?
- API数が少ないためとりあえずファイルの分割はしていない
	- 今後ファイルの分割をしても良いと考えている、ただしフォルダを作ってまでの分割は不要と考えている
- String型を返却するようにして利用側にてjsonをdecodeしてmodelsの型に変換するようにしている
	- [課題] これはあまりいい実装じゃない、apiはいわゆるクリーンアーキテクチャでいうところのrepositoryレイヤーに相当する、今はHTTPリクエストを利用しているが将来的にはGraphQLやtRPC, gRPC-webなど別のプロトコルに対応してもapi以外への影響が出ないようなレイヤーとなっていることが望ましいが、現状そういう実装になっていない。modelsとのdata transfer object(dto)を作成してブリッジするなど適用できるパターンはいくつかありそう。とはいえまだアーキテクトしてない。とはいえfromJsonとかはdtoぽい、んーうまくできてそうな部分もあるが、現状modelsはapiのためのmodelsで、uiのためのmodelsになってない、apiのためのmodelsとuiのためのmodelsを分けるのもToo Muchな気がするなど、今後のアーキテクチャの発展への堅牢性の維持とちょうどいい塩梅がムズイ。がもうちょい考えればいいところが見つかりそうな気がする。この辺はcopilotなどと相談して決着させられそう。
