# Google認証＋課金機能 実装計画ドキュメント

**作成日**: 2026-02-17  
**決定事項**: 方針B（段階的リリース戦略）を採用

---

## 📋 ドキュメント一覧

### 🎯 メインドキュメント（必読）

#### 1. [最終決定: 方針B](./2026-02-17-final-decision-plan-b.md) ⭐⭐⭐⭐⭐
- **概要**: 段階的リリース戦略の最終決定サマリー
- **内容**: v1.0無料版 → v2.0課金版のリリース計画
- **対象**: 全員
- **読む順序**: 1番目

#### 2. [実装計画全体](./2026-02-17-auth-billing-migration-plan.md) ⭐⭐⭐⭐⭐
- **概要**: Phase 0～6の詳細な実装計画
- **内容**: 各Phaseのタスク、期間、成果物
- **対象**: 開発者
- **読む順序**: 2番目

---

### 📚 参考ドキュメント（必要に応じて参照）

#### 3. [課金のみ vs 認証+課金](./2026-02-17-billing-only-vs-auth-billing.md)
- **概要**: 課金機能のみで実装する場合の問題点
- **内容**: 認証が必要な理由、機種変更対応の重要性
- **対象**: 意思決定者
- **参照タイミング**: 方針決定時

#### 4. [iOS認証戦略](./2026-02-17-ios-auth-billing-strategy.md)
- **概要**: iOSでの認証・課金戦略
- **内容**: Sign in with Appleの必要性、クロスプラットフォーム対応
- **対象**: iOS開発者、意思決定者
- **参照タイミング**: Phase 3（認証機能実装）

#### 5. [Google認証の目的](./2026-02-17-google-auth-purposes.md)
- **概要**: Google認証を使う10の目的
- **内容**: JWT/JWKS、ユーザー唯一性、UX向上、セキュリティ外部委託など
- **対象**: 開発者、意思決定者
- **参照タイミング**: Phase 3（認証機能実装）

#### 6. [Phase順序の理由](./2026-02-17-phase-ordering-rationale.md)
- **概要**: なぜこのPhase順序なのかの詳細説明
- **内容**: 依存関係、リスク管理、段階的リリースの重要性
- **対象**: 開発リーダー
- **参照タイミング**: 実装開始前

---

### 🔍 レビュードキュメント（記録用）

#### 7. [ドキュメント矛盾点の整理](./2026-02-17-documentation-consistency-review.md)
- **概要**: 作成したドキュメント間の矛盾チェック結果
- **内容**: 3つの方針（A/B/C）の比較、リスク分析
- **対象**: プロジェクト管理者
- **参照タイミング**: レビュー時

#### 8. [既存ガイドラインとの統合](./2026-02-17-guideline-integration-review.md)
- **概要**: 既存のagent_fix_guidelinesとの整合性チェック
- **内容**: 既存ドキュメントとの関係性、追加すべき調査項目
- **対象**: アーキテクト
- **参照タイミング**: Phase 0（準備・調査）

---

## 🎯 リリース計画サマリー

### v1.0 無料版
- **リリース時期**: Phase 2完了時点（約7週間 = 2ヶ月弱）
- **機能**: ローカルDB（Drift）のみ、認証なし
- **制約**: 機種変更でデータ消失、複数デバイス同期不可
- **目的**: 早期リリース、審査リスク回避

### v2.0 課金版
- **リリース時期**: Phase 6完了時点（約20週間 = 5ヶ月）
- **機能**: Google + Apple認証、課金機能、サーバー同期
- **移行**: v1.0ユーザーのデータ自動移行
- **目的**: 収益化、クロスデバイス対応

---

## 📅 実装スケジュール

| Phase | 期間 | 完了予定 | 成果物 |
|-------|------|---------|--------|
| Phase 0 | 1-2週間 | Week 2 | 技術調査・設計 |
| Phase 1 | 2-3週間 | Week 5 | ローカルDB実装 |
| Phase 2 | 2週間 | Week 7 | Repository抽象化 |
| **📦 v1.0** | - | **Week 7** | **無料版リリース** |
| Phase 3 | 3-4週間 | Week 11 | Google + Apple認証 |
| Phase 4 | 2-3週間 | Week 14 | 課金機能 |
| Phase 5 | 3-4週間 | Week 18 | 同期機能 |
| Phase 6 | 2週間 | Week 20 | 統合テスト |
| **📦 v2.0** | - | **Week 20** | **課金版リリース** |

---

## 🔑 重要な技術選択

### 認証
- **Google認証**: 全プラットフォーム
- **Sign in with Apple**: iOS（App Store審査対応）
- **Firebase Auth**: 統合管理

### 課金
- **in_app_purchase**: 基本実装
- **RevenueCat**: Phase 0で評価予定（推奨）

### ローカルDB
- **Drift**: SQLiteラッパー

### 同期戦略
- **書き込み**: ローカル即座保存 → バックグラウンドでサーバー送信
- **読み込み**: ローカルから即座表示 → バックグラウンドで更新
- **競合解決**: Last-Write-Wins

---

## 📖 読む順序の推奨

### 初めて読む場合
1. [最終決定: 方針B](./2026-02-17-final-decision-plan-b.md) - 全体像を把握
2. [実装計画全体](./2026-02-17-auth-billing-migration-plan.md) - 詳細な計画を確認

### Phase実装時
- **Phase 0**: [既存ガイドラインとの統合](./2026-02-17-guideline-integration-review.md)
- **Phase 1-2**: [実装計画全体](./2026-02-17-auth-billing-migration-plan.md)のPhase 1-2を参照
- **Phase 3**: [iOS認証戦略](./2026-02-17-ios-auth-billing-strategy.md) + [Google認証の目的](./2026-02-17-google-auth-purposes.md)
- **Phase 4**: [実装計画全体](./2026-02-17-auth-billing-migration-plan.md)のPhase 4を参照
- **Phase 5-6**: [実装計画全体](./2026-02-17-auth-billing-migration-plan.md)のPhase 5-6を参照

### レビュー時
- [ドキュメント矛盾点の整理](./2026-02-17-documentation-consistency-review.md)
- [Phase順序の理由](./2026-02-17-phase-ordering-rationale.md)

---

## 🔗 関連ドキュメント

### プロジェクト内の既存ガイドライン

以下のドキュメントは今回の計画の「前段階の検討資料」として作成されていました:

- `../agent_fix_guidelines/2026-01-21-subscription-architecture-plan.md` - サブスクリプション詳細設計
- `../agent_fix_guidelines/2026-01-07-repository-layer-implementation.md` - Repository層ガイド
- `../agent_fix_guidelines/2026-01-19-architecture-improvement-roadmap.md` - アーキテクチャ改善ロードマップ

**関係性**: 今回の計画は上記ガイドラインを「実装可能な形に具体化したもの」

---

## ✅ 次のアクション

1. ✅ 方針決定（完了）
2. ✅ ドキュメント作成（完了）
3. ✅ ドキュメント整理（完了）
4. Phase 0の技術調査開始
   - RevenueCat vs in_app_purchase評価
   - Driftの詳細調査
   - データベーススキーマ設計
5. Phase 1のタスク分解とissue作成
6. 開発開始 🚀

---

## 📝 変更履歴

| 日付 | 変更内容 |
|------|---------|
| 2026-02-17 | 初版作成、全8ドキュメント作成 |
| 2026-02-17 | フォルダにまとめてREADME追加 |

---

## 👥 対象読者

- **開発者**: Phase実装時の詳細ガイドとして
- **プロジェクト管理者**: スケジュール管理とマイルストーン確認
- **意思決定者**: 戦略的判断の根拠として
- **アーキテクト**: 技術選択の妥当性確認

---

## 💡 補足

このドキュメント群は約1日で作成されました。
各ドキュメントは独立して読めますが、全体として一貫性を持つように設計されています。

疑問点や追加が必要な内容があれば、このREADMEまたは個別ドキュメントを更新してください。
